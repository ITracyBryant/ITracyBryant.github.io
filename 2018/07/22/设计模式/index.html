<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="With the eyes of programmer to more understanding of the world——ITracyBryant's blog"><title>设计模式 | Evolving</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">设计模式</h1><a id="logo" href="/.">Evolving</a><p class="description">One man and a Crowd</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">设计模式</h1><div class="post-meta">Jul 22, 2018<span> | </span><span class="category"><a href="/categories/note/">note</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="post-content"><p>singleton<br>单例模式：有些对象我们只需要一个 —&gt; 配置文件，工具类，线程池，缓存，日志对象等（如果创造出多个实例，就会导致许多问题，像占用过多资源，不一致结果等)</p>
<p>饿汉模式和懒汉模式</p>
<p>模板方法模式 (template method)：算法执行的统一框架 –&gt;step1,step2（子类中实现）,…,step n<br>    定义了一个操作算法的骨架，将一些步骤延迟到子类中实现，使得子类可以在不改变一个算法结构的同时，就可以重新定义该算法的特定步骤。<br>    好莱坞原则：子类可以替换掉父类中的可变逻辑，但是不能改变整体逻辑结构<br>实现要素：准备一个抽象类，将部分逻辑以具体方法的形式实现，然后声明一些抽象方法交由子类实现剩余逻辑，用钩子方法给予子类更大的灵活性，最后将方法汇总构成一个不可改变的模板方法<br>适用场景：1. 算法或操作遵循相似的逻辑 2. 重构时（把相同的代码抽取到父类模板中) 3. 重要复杂的算法，核心算法设计为模板方法<br>优势：封装性好，复用性好，屏蔽细节，便于维护<br>劣势：java 单继承，抽象基类，无法实现多继承（接口实现)<br>行业案例：分析 ISP 运营商的运行日志 –&gt;种类繁多数量巨大的日志 –&gt;抽取共性 –&gt;获取规律 (template method)（获得文件，打开文件，读取日志结构，处理单行日志（延迟到子类实现)，清理工作)<br>      扩展点 (hook)：beforeProcessOneFile(); afterProcessOneFile();</p>
<p>适配器模式 (Adapter)：将一个类的接口，转换成客户期望的另外一个接口，使得原本由于接口不兼容而不能一起工作的那些类可以一起工作（把不兼容的变成兼容的)<br>组合：采用组合方式的适配器称为对象适配器，特点：把”被适配者”作为一个对象组合到适配器类中，以修改目标接口来包装被适配者<br>继承：采用继承方式的适配器称为类适配器，特点：通过多重继承不兼容接口，实现对目标接口的匹配，单一的为某个类而实现适配<br>作用：1. 透明：通过适配器，客户端可以调用同一接口，因而对客户端来说是透明的，这样做更简单，更直接，更紧凑。</p>
<pre><code>2. 重用：复用了现存的类，解决了现存类和复用环境要求不一致的问题。
3. 低耦合：将目标类和适配者类解耦，通过引入一个适配器类重用现有的适配者类，而无需修改原有代码（遵循开闭原则（对修改关闭，对扩展开放）)。
</code></pre><p>策略模式 (Strategy)：将可变的部分从程序中抽象分离成算法接口，在该接口下分别封装一系列算法实现，并使他们可以相互替换，从而导致客户端程序独立于算法的改变（通过分离变化，抽象出不变的部分，定义算法族分别封装起来，对新增需求弹性支持)<br>    （通过开发与重构，使用策略模式，不变更代码框架，拥抱需求的变化）<br>    继承：在父类中提供实现方法，子类通过继承获得父类的实现功能（重用，但不具有灵活性，可扩展性差)，需要在子类 override 该方法以提供新的功能<br>    抽象方法：在父类中提供抽象方法，强制子类自己实现对应功能（灵活，但没有复用)<br>    组合：将需要实现的行为功能抽象为接口，在父类中持有该接口，并由该接口代理该行为功能（灵活，可复用易维护，但实例化的对象增多)<br>    Favor composition over inheritance（组合优先于继承) 面向对象中的组合是 has-a 的关系<br>    Composition：在类中增加一个私有域，引用另一个已有的类的实例，通过调用引用实例的方法从而获得新的功能，这种设计被称作组合（复合)<br>    设计原则：change 找出应用中需要变化的部分，把他们独立出来，不要和那些不需要变化的代码混合在一起（将不变抽象为接口，将变化交由实现（接口的实现类))<br>          面向接口编程，而不是面向实现编程（接口提供契约，在总体上规定双方行为框架，通过多态用不同的实现类来实现多样性)<br>    实现步骤：1. 通过分离变化得出策略接口 Strategy<br>          2.Strategy 的实现类</p>
<pre><code>      3. 在客户程序（抽象父类) 中持有 Strategy
      4. 在客户程序中选择（组装) 正确的 Strategy 实现
优点：1. 使用组合，使架构更加灵活
      2. 可扩展性好，能够较好的应对变化（遵循开闭原则)
      3. 更好的代码复用性（相对于继承)
      4. 消除了大量的条件语句（可读性，面向对象特性更好)
缺点：1. 客户代码需要了解每个策略实现的细节
      2. 增加了实现对象的数目
适用场景：1. 在历史遗留系统中，许多相关类仅仅是行为差异，则可以考虑将这些差异的共性分离出来，成为一个策略接口（相关类便是算法家族的成员)
      2. 运行时选取不同的算法变体
      3. 通过条件语句在多个分支中选取其一
</code></pre><p>工厂模式：实例化对象，用工厂方法代替 new 操作；工厂模式包括工厂方法模式和抽象工厂模式；抽象工厂模式是工厂方法模式的扩展。<br>    工厂模式的意图：定义一个接口来创建对象，但是让子类来决定哪些类需要被实例化；工厂方法把实例化的工作推迟到子类中去实现。<br>    适用场景：有一组类似的对象需要创建；在编码时不能预见需要创建哪种类的实例；系统需要考虑扩展性，不应依赖于产品类实例如何被创建，组合和表达的细节。（低耦合)<br>    动机（项目中的现状)：在软件系统中经常面临着”对象”的创建工作，由于需求的变化，这个对象可能随之也会发生变化，但它却拥有比较稳定的接口，因此，需要提供一种封装机制来隔离出这个易变对象的变化，从而保持系统中其他依赖该对象的对象不随着需求变化而变化。<br>    基于项目现状将代码如下设计：尽量松耦合，一个对象的依赖对象的变化与本身无关；具体产品与客户端剥离，责任分割。<br>    常见应用：JDBC–&gt;用于执行 sql 语句的 API，可以为多种关系数据库提供统一访问，由一组用 Java 语言编写的类和接口组成（客户端 –&gt;数据操作工厂 –&gt;jdbc 接口)<br>          Spring BeanFactory–&gt;BeanFactory 作为 Spring 基础的 IoC 容器，是 Spring 的一个 Bean 工厂。如果单从工厂模式的角度思考，它就是用来”生产 Bean”，然后提供给客户端。<br>          Bean 实例化过程：1. 调用 Bean 的默认构造方法，或指定的构造方法，生成 Bean 实例（暂称 instance1)</p>
<pre><code>              2. 如果 Bean 的配置文件中注入了 Bean 属性值，则在 instance1 基础上进行属性注入形成 instance2，这种注入是覆盖性的
              3. 如果 Bean 实现了 InitializingBean 接口，则调用 afterPropertiesSet() 方法，来改变或操作 instance2，得到 instance3
              4. 如果 Bean 的配置文件中指定了 init-method=&quot;init&quot;属性，则会调用指定的初始化方法，则在 instance3 的基础上调用初始化方法 init(), 将对象最终初始化为 instance4。（初始化的名字是任意的)
工厂方法模式和抽象工厂模式的对比：
    1. 工厂模式是一种极端情况的抽象工厂模式，而抽象工厂模式可以看成是工厂模式的推广
    2. 工厂模式用来创建一个产品的等级结构，而抽象工厂模式是用来创建多个产品的等级结构
    3. 工厂模式只有一个抽象产品类，而抽象工厂模式有多个抽象产品类
优点：1. 系统可以在不修改具体工厂角色的情况下引进新的产品
      2. 客户端不必关心对象如何创建，明确了职责
      3. 更好的理解面向对象原则，面向接口编程，而不要面向实现编程
适用场景：1. 一个系统应当不依赖于产品类实例被创立，组成，表示的细节，这对于所有形态的工厂模式都是重要的
      2. 这个系统的产品有至少一个的产品族
      3. 同属于同一个产品族的产品是设计成在一起使用的，这一约束必须在系统的设计中体现出来
      4. 不同的产品以一系列接口的面貌出现，从而使系统不依赖于接口实现的细节
</code></pre><p>代理模式 (proxy)：为其他对象提供一种代理以控制对这个对象的访问，代理对象起到中介作用，可去掉功能服务或增加额外的服务。<br>    常见的代理模式：远程代理 –&gt;为不同地理的对象提供局域网代表对象（监控)<br>            虚拟代理 –&gt;根据需要将资源消耗很大的对象进行延迟，真正需要的时候进行创建（图片加载时的替代)<br>            保护代理 –&gt;控制对一个对象的访问权限（权限控制)<br>            智能引用代理 –&gt;提供对目标对象额外的一些服务（提供额外服务)<br>    智能引用代理：两种实现方式 –&gt;静态代理，动态代理<br>        静态代理：代理和被代理对象在代理之前是确定的，他们都实现相同的接口或继承相同的抽象类（通过继承和聚合的方式实现)<br>              聚合方式更适合代理模式（继承方式会使代理类无限膨胀下去)<br>        JDK 动态代理：（动态产生代理，实现对不同类，不同方法的代理) 在代理类和被代理类之间加入了实现 InvocationHandler 的 ProxyHandler 类（事务处理器)<br>                 位于 java.lang.reflect 包下，一般主要涉及两个类：<br>                1.Interface InvocationHandler：该接口中仅定义了一个方法 public object invoke(Object obj,Method method,Object[] args), 在实际使用时，第一个参数 obj 一般指代理类，method 是被代理的方法，args 为该方法的参数数组。这个抽象方法在代理类中动态实现。<br>                2.Proxy：该类即为动态代理类，static Object newProxyInstance(ClassLoader loader,Class[] interfaces,InvocationHandler h): 返回代理类的一个实例，返回后的代理类可以当作被代理类使用（可使用被代理类的在接口中声明过的方法)<br>                 Dynamic Proxy 是这样一种 class：它是在运行时生成的 class，该 class 需要实现一组 interface，使用动态代理类时，必须实现 InvocHandler 接口（具体业务在对应 Handler 中实现)<br>                 实现步骤：1. 创建一个实现接口 InvocationHandler 的类，它必须实现 invoke 方法（具体业务逻辑)</p>
<pre><code>               2. 创建被代理的类以及接口
               3. 调用 Proxy 的静态方法 newProxyInstance，动态创建一个代理类
               4. 通过代理调用方法
两者区别：JDK 动态代理：1. 只能代理实现了接口的类；2. 没有实现接口的类不能实现 JDK 的动态代理  （对实现某些接口的任意类，任意方法产生任意代理)
      CGLIB 动态代理：1. 针对类来实现代理的；2. 对指定目标类产生一个子类，通过方法拦截技术拦截所有父类方法的调用
使用 CGLib 动态代理
应用：日志处理，权限管理，事务处理  ----- 如果想调用某个 jar 包中的某个类的方法，不能修改源码的情况下，可以采用代理模式在方法前后增加一些特殊的业务逻辑 -----&gt;即 AOP（在不该原有类方法的基础上增加一些额外的业务逻辑)
</code></pre><p>责任链模式 (Chain of Responsiblity)：将接收者对象连成一条链，并在该链上传递请求，直到有一个接收者对象处理它。通过让更多对象有机会处理请求，避免了请求发送者和接收者之间的耦合。<br>    责任链模式中，作为请求接收者的多个对象通过对其后继的引用而连接起来形成一条链。请求在这条链上传递，直到链上某一个接收者处理这个请求，每个接收者都可以选择自行处理请求或是向后继传递请求。发出请求的客户端并不需要知道链上的哪一个接收者会处理这个请求，从而实现了客户端和接收者之间的解耦。<br>    应用：异常处理机制 (Exception Handling)</p>
<p>观察者模式：定义对象间的一种一对多的依赖关系。当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。</p>
</div><iframe src="/donate/?AliPayQR=/img/AliPayQR.png&amp;WeChatQR=/img/WeChatQR.png&amp;GitHub=null&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden;overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="https://itracybryant.github.io/2018/07/22/设计模式/" data-id="cjr7vn74d0018ik5de18cbfpy" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACJElEQVR42u3aQW7DMAwEwPz/0+4DCjtL0i5qaXQK2kTJ+EBoRX4+8Tp+rd57fr//bIfPEwsDA+O1jONyXX/B9ad6+1///ZSKgYGxAeO6IJ69TgpoUiGT7/2yMwYGBka8dVQcT/Y8K7gYGBgYVUYvXeZxFwMDA2MSYvOrsUnpfDyLY2BgvJBRLZp/+fqR/gYGBsarGEdxTajJPkdrYWBgrM3IC1w1dubNyCigJk0FDAyMRRn3Dkkk4TanFmAYGBjbMO4quPNCXD1uYmBgrM3Ii2DvZ00A+WAHBgbGnoxe0/Gu0bG8OYqBgbEDIw+Q+U+vNiObd4TJCRQDA2M5Rq+A5uW4d0sW/RcDA2NpRjXE/p/z7CiLY2BgvJBRvWjLMZOD4+P3hRgYGC9kJFf/k2ZncmRsDltgYGBsw8iLY7VJmTyU6nDYl6MhBgbG0ozrIti7Suu1HMrtBAwMjKUZvcA5uUrLP1V9rBgYGKsyjnjlgLypOWkwFLoQGBgYSzBGAbIVWXsF+vQBYWBgbMPotRLnV3V5i6KeazEwMNZh9ArovEnwideXaI2BgbEo4yiuauz8tFY+rlFO4RgYGC9kTLbuXbolDcvbDosYGBgLMXpFdn68q8bj0ZPGwMBYgpFMWFXbk73HdMNAGAYGxvaMZGxrPjyRHyUxMDAw8oI4HwtLdj7FY2BgbMDIG5O9OPpckMbAwNiBUY2OvQg6aYtWG6gYGBgLMX4ArDki4Pkr9OMAAAAASUVORK5CYII=" class="article-share-link">分享</a><div class="tags"><a href="/tags/Java/">Java</a></div><div class="post-nav"><a href="/2018/05/04/Hibernate/" class="next">Hibernate</a></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://itracybryant.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/note/">note</a><span class="category-list-count">16</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/07/22/设计模式/">设计模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/04/Hibernate/">Hibernate</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/29/JVM/">JVM</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/05/Servlet/">Servlet</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/02/Maven/">Maven</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/02/Listener-Filter/">Listener&Filter</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/01/Reflect/">Reflect</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/01/Annotation/">Annotation</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/30/JavaBean/">JavaBean</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/30/JSP指令与动作-JSP中Cookie的使用/">JSP指令与动作&JSP中Cookie的使用</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://www.haomwei.com/" title="屠城" target="_blank">屠城</a><ul></ul><a href="https://luuman.github.io/Home/H1/index.html" title="世平阜康" target="_blank">世平阜康</a><ul></ul><a href="https://diygod.me/" title="DIYgod" target="_blank">DIYgod</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">Evolving.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>